#/bin/sh
#
#   Bindle Binaries Tools
#   Copyright (C) 2011 Bindle Binaries <syzdek@bindlebinaries.com>.
#
#   @BINDLE_BINARIES_BSD_LICENSE_START@
#
#   Redistribution and use in source and binary forms, with or without
#   modification, are permitted provided that the following conditions are
#   met:
#
#      * Redistributions of source code must retain the above copyright
#        notice, this list of conditions and the following disclaimer.
#      * Redistributions in binary form must reproduce the above copyright
#        notice, this list of conditions and the following disclaimer in the
#        documentation and/or other materials provided with the distribution.
#      * Neither the name of Bindle Binaries nor the
#        names of its contributors may be used to endorse or promote products
#        derived from this software without specific prior written permission.
#
#   THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
#   IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
#   THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
#   PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL BINDLE BINARIES BE LIABLE FOR
#   ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
#   DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
#   SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
#   CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
#   LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
#   OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
#   SUCH DAMAGE.
#
#   @BINDLE_BINARIES_BSD_LICENSE_END@
#
#   @configure_input@
#
#   Makefile.am - automate compiling on a unix platform
#

progname=`basename ${0}`

LN="ln"
CP="cp"
MKDIR="mkdir"
RM="rm"

func_echo()
{
   echo "$*"
}

func_error()
{
    echo "$progname: "${1+"$@"} 1>&2
}

func_help()
{
   func_echo "$progname [OPTION]..."
   func_echo "  -c, --copy          copy files rather than symlinking them"
   func_echo "  -d, --debug         enable verbose shell tracing"
   func_echo "  -f, --force         replace existing files"
   func_echo "  -h, --help          print short or long help message"
   func_echo "  -i, --install       copy missing auxiliary files"
   func_echo "  -n, --dry-run       print commands rather than running them"
   func_echo "  -q, --quiet         work silently"
   func_echo "  -v, --verbose       verbosely report processing"
   func_echo "  -V, --version       print version information and exit"
   func_echo ""
   func_echo "Report bugs to <syzdek@bindlebinaries.com>."
}

my_sed_traces='
   /AC_CONFIG_AUX_DIR(/ {
      s,^.*AC_CONFIG_AUX_DIR([[    ]*\([^])]*\).*$,ac_auxdir=\1,
      p
   }
   /AC_CONFIG_MACRO_DIR(/ {
      s,^.*AC_CONFIG_MACRO_DIR([[  ]*\([^])]*\).*$,ac_macrodir=\1,
      p
   }
   d'
eval `cat configure.ac 2>/dev/null | sed "$my_sed_traces"`

# Option defaults:
opt_copy=false
opt_force=false
opt_install=false
opt_dry_run=false
opt_quiet=false
opt_verbose=false
opt_warning=:

# parses command line options
while test $# -gt 0;do
   opt="$1"
   shift
   case $opt in
      --debug|-x)
         opt_debug='set -x'
         func_echo "enabling shell trace mode"
         $opt_debug
         ;;

      --copy|-c)
         opt_copy=:
         ;;

      --force|-f)
         opt_force=:
         ;;

      --install|-i)
         opt_install=:
         ;;

      --dry-run|--dryrun|-n)
         opt_dry_run=:
         CP="func_echo $CP"
         LN="func_echo $LN"
         MKDIR="func_echo $MKDIR"
         RM="func_echo $RM"
         ;;

      --quiet|-q)
         opt_quiet=:
         ;;

      --verbose|-v)
         opt_verbose=:
         ;;

      -\?|-h|--help)
         func_help
         exit 0
         ;;

      --version|-V)
         func_version
         exit 0
         ;;

      *)
         func_error "unrecognized option \`$opt'"
         func_error "Try \`$progname --help' for more information."
         exit 1
         ;;
   esac
done

$MKDIR test

# end of script
